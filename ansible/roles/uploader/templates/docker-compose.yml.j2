version: "3.6"
services:
  uploader:
    image: thecodingmachine/workadventure-uploader:${VERSION}
    ports:
      - "8080:8080"
    environment:
      - UPLOADER_URL=https://${UPLOADER_HOST}
      #AWS
      - AWS_ACCESS_KEY_ID=${AWS_ACCESS_KEY_ID}
      - AWS_SECRET_ACCESS_KEY=${AWS_SECRET_ACCESS_KEY}
      - AWS_DEFAULT_REGION=${AWS_DEFAULT_REGION}
      - AWS_BUCKET=${AWS_BUCKET}
      - AWS_URL=${AWS_URL}
      - AWS_ENDPOINT=${AWS_ENDPOINT}
      #REDIS
      - REDIS_HOST=${UPLOADER_REDIS_HOST}
      - REDIS_PORT=${UPLOADER_REDIS_PORT}
      #CHAT
      #- ADMIN_API_URL=${ADMIN_API_URL}
      - ENABLE_CHAT_UPLOAD=${ENABLE_CHAT_UPLOAD}
      - UPLOAD_MAX_FILESIZE=${UPLOAD_MAX_FILESIZE}
    # labels:
    #   traefik.enable: "true"
    #   traefik.http.routers.uploader.rule: "Host(`${UPLOADER_HOST}`)"
    #   traefik.http.routers.uploader.entryPoints: "web"
    #   traefik.http.services.uploader.loadbalancer.server.port: "8080"
    #   traefik.http.routers.uploader-ssl.rule: "Host(`${UPLOADER_HOST}`)"
    #   traefik.http.routers.uploader-ssl.entryPoints: "websecure"
    #   traefik.http.routers.uploader-ssl.service: "uploader"
    #   traefik.http.routers.uploader-ssl.tls: "true"
    #   traefik.http.routers.uploader-ssl.tls.certresolver: "myresolver"
